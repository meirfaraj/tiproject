require("std/num")
require("std/array")
chi2={}
chi2.table={}
chi2.table.start = 0
chi2.table.step =0.001
chi2.table.val = {
    0.000000393,  0.00000157,  0.0000393,  0.000157,  0.000982,  0.00393,  0.0158,  0.0642,  0.148,  0.275,  0.455,  0.708,  1.074,  1.642,  2.706,  3.841,  3.024,  6.635,  7.879, 10.828, 12.116,
    0.00100    ,  0.00200   ,  0.0100   ,  0.0201  ,  0.0506  ,  0.103  ,  0.211 ,  0.446 ,  0.713,  1.022,  1.386,  1.833,  2.408,  3.219,  4.605,  5.991,  7.378,  9.210, 10.597, 13.816, 15.202,
    0.0150     ,  0.0243    ,  0.0717   ,  0.115   ,  0.216   ,  0.352  ,  0.584 ,  1.005 ,  1.424,  1.869,  2.366,  2.946,  3.665,  4.642,  6.251,  7.815,  9.348, 11.345, 12.838, 16.266, 17.730, 
    0.0639     ,  0.0908    ,  0.207    ,  0.297   ,  0.484   ,  0.711  ,  1.064 ,  1.649 ,  2.195,  2.753,  3.357,  4.045,  4.878,  5.989,  7.779,  9.488, 11.143, 13.277, 14.860, 18.467, 19.998,
   
    0.158      ,  0.210     ,  0.412    ,  0.554   ,  0.831   ,  1.145  ,  1.610 ,  2.343 ,  3.000,  3.655,  4.351,  5.132,  6.064,  7.289,  9.236, 11.070, 12.832, 15.086, 16.750, 20.515, 22.105,  
    0.299      ,  0.381     ,  0.676    ,  0.872   ,  1.237   ,  1.635  ,  2.204 ,  3.070 ,  3.828,  4.570,  5.348,  6.211,  7.231,  8.558, 10.645, 12.592, 14.449, 16.812, 18.548, 22.458, 24.103,
    0.485      ,  0.598     ,  0.989    ,  1.239   ,  1.690   ,  2.167  ,  2.833 ,  3.822 ,  4.671,  5.493,  6.346,  7.283,  8.383,  9.803, 12.017, 14.067, 16.013, 18.475, 20.278, 24.322, 26.018,
    0.710      ,  0.857     ,  1.344    ,  1.646   ,  2.180   ,  2.733  ,  3.490 ,  4.594 ,  5.527,  6.423,  7.344,  8.351,  9.624, 11.030, 13.362, 15.507, 17.535, 20.090, 21.955, 26.125, 27.868,
    0.972      ,  1.153     ,  1.735    ,  2.088   ,  2.700   ,  3.325  ,  4.168 ,  5.380 ,  6.393,  7.393,  8.343,  9.414, 10.656, 12.242, 14.684, 16.919, 19.023, 21.666, 23.585, 27.877, 29.666,
   
    1.265      ,  1.479     ,  2.151    ,  2.558   ,  3.247   ,  3.940  ,  4.865 ,  6.179 ,  7.267,  8.295,  9.342, 10.473, 11.781, 13.442, 15.987, 18.307, 20.483, 23.209, 25.188, 29.588, 31.419,
    1.587      ,  1.834     ,  2.603    ,  3.053   ,  3.816   ,  4.575  ,  5.578 ,  6.989 ,  8.148,  9.237, 10.341, 11.530, 12.899, 14.631, 17.275, 19.675, 21.920, 24.725, 26.757, 31.264, 33.136,
    1.934      ,  2.214     ,  3.074    ,  3.571   ,  4.404   ,  5.226  ,  6.304 ,  7.807 ,  9.034, 10.182, 11.340, 12.584, 14.011, 15.812, 18.549, 21.026, 23.336, 26.217, 28.300, 32.909, 34.821,
    2.305      ,  2.617     ,  3.565    ,  4.107   ,  5.009   ,  5.892  ,  7.042 ,  8.634 ,  9.926, 11.129, 12.340, 13.636, 15.119, 16.985, 19.812, 22.362, 24.736, 27.688, 29.818, 34.528, 36.478,
    2.697      ,  3.041     ,  4.075    ,  4.660   ,  5.629   ,  6.571  ,  7.790 ,  9.467 , 10.821, 12.079, 13.339, 14.685, 16.222, 18.151, 21.064, 23.685, 26.119, 29.141, 31.319, 36.123, 38.109,
   
    3.108      ,  3.483     ,  4.601    ,  5.229   ,  5.262   ,  7.261  ,  8.547 , 10.307 , 11.721, 13.030, 14.339, 15.733, 17.322, 19.311, 22.307, 24.996, 27.488, 30.578, 32.801, 37.697, 39.719,
    3.536      ,  3.942     ,  5.142    ,  5.812   ,  6.908   ,  7.962  ,  9.312 , 11.152 , 12.624, 13.983, 15.338, 16.780, 18.418, 20.465, 23.542, 26.296, 28.845, 32.000, 34.267, 39.252, 41.308,
    3.980      ,  4.416     ,  5.697    ,  6.408   ,  7.564   ,  8.672  , 10.085 , 12.002 , 13.531, 14.937, 16.338, 17.824, 19.511, 21.615, 24.769, 27.587, 30.191, 33.409, 35.718, 40.790, 42.879,
    4.439      ,  4.905     ,  6.265    ,  7.015   ,  8.231   ,  9.390  , 10.865 , 12.857 , 14.440, 15.893, 17.338, 18.868, 20.601, 22.750, 25.989, 28.869, 31.526, 34.805, 37.156, 42.312, 44.434,    
    4.912      ,  5.407     ,  6.844    ,  7.633   ,  8.907   , 10.117  , 11.651 , 13.716 , 15.352, 16.850, 18.338, 19.910, 21.689, 23.900, 27.204, 30.144, 32.852, 36.191, 38.582, 43.820, 45.973,
   
    5.398      ,  5.921     ,  7.434    ,  8.260   ,  9.591   , 10.851  , 12.443 , 14.578 , 16.266, 17.809, 19.337, 20.951, 22.775, 25.038, 28.412, 31.410, 34.170, 37.566, 39.997, 45.315, 47.498,
    5.896      ,  6.447     ,  8.034    ,  8.897   , 10.283   , 11.591  , 13.240 , 15.445 , 17.182, 18.768, 20.337, 21.991, 23.858, 26.171, 29.615, 32.671, 35.479, 38.932, 41.401, 46.797, 49.010, 
    6.405      ,  6.983     ,  8.643    ,  9.542   , 10.982   , 12.338  , 14.041 , 16.314 , 18.101, 19.729, 21.337, 23.031, 24.939, 27.301, 30.813, 33.924, 36.781, 40.289, 42.796, 48.268, 50.511, 
    6.924      ,  7.529     ,  9.260    , 10.196   , 11.688   , 13.091  , 14.848 , 17.187 , 19.021, 20.690, 22.337, 24.069, 26.018, 28.429, 32.007, 35.172, 38.076, 41.638, 44.181, 49.728, 52.000,
    7.453      ,  8.085     ,  9.886    , 10.856   , 12.401   , 13.848  , 15.659 , 18.062 , 19.943, 21.652, 23.337, 25.106, 27.096, 29.553, 33.196, 36.415, 39.364, 42.980, 45.558, 51.179, 53.479,
   
    7.991      ,  8.649     , 10.520    , 11.524   , 13.120   , 14.611  , 16.473 , 18.940 , 20.867, 22.616, 24.337, 26.143, 28.172, 30.675, 34.382, 37.652, 40.646, 44.314, 46.928, 52.620, 54.947,
    8.538      ,  9.222     , 11.160    , 12.198   , 13.844   , 15.379  , 17.292 , 19.820 , 21.792, 23.579, 25.336, 27.179, 29.246, 31.795, 35.563, 38.885, 41.923, 45.642, 48.290, 54.052, 56.407,
    9.093      ,  9.803     , 11.808    , 12.879   , 14.573   , 16.151  , 18.114 , 20.703 , 22.719, 24.544, 26.336, 28.214, 30.319, 32.912, 36.741, 40.113, 43.194, 46.963, 49.645, 55.476, 57.858,
    9.656      , 10.391     , 12.461    , 13.565   , 15.308   , 16.928  , 18.939 , 21.588 , 23.647, 25.509, 27.336, 29.249, 31.391, 34.027, 37.916, 41.337, 44.461, 48.278, 50.993, 56.892, 59.300,
   10.227      , 10.986     , 13.121    , 14.256   , 16.047   , 17.708  , 19.768 , 22.475 , 24.577, 26.475, 28.336, 30.283, 32.461, 35.139, 39.087, 42.557, 45.722, 49.588, 52.336, 58.302, 60.734,
   
   10.804      , 11.588     , 13.787    , 14.953   , 16.791   , 18.493  , 20.599 , 23.364 , 25.508, 27.442, 29.336, 31.316, 33.530, 36.250, 40.256, 43.773, 46.979, 50.892, 53.672, 59.703, 62.161,
   11.389      , 12.196     , 13.458    , 15.655   , 17.539   , 19.281  , 21.434 , 24.255 , 26.440, 28.409, 30.336, 32.349, 34.598, 37.359, 41.422, 44.985, 48.232, 52.191, 55.003, 61.098, 63.582,
   11.979      , 12.811     , 15.134    , 16.362   , 18.291   , 20.072  , 22.271 , 25.148 , 27.373, 29.376, 31.336, 33.381, 35.665, 38.466, 42.585, 46.194, 49.480, 53.486, 56.328, 62.487, 64.995,
   12.576      , 13.431     , 15.815    , 17.073   , 19.047   , 20.867  , 23.110 , 26.042 , 28.307, 30.344, 32.336, 34.413, 36.731, 39.572, 43.745, 47.400, 50.725, 54.776, 57.648, 63.870, 66.402,
   13.179      , 14.057     , 16.501    , 17.789   , 19.806   , 21.664  , 23.952 , 26.938 , 29.242, 31.313, 33.336, 35.444, 37.795, 40.676, 44.903, 48.602, 51.966, 56.061, 58.964, 65.247, 67.803,
   
   13.788      , 14.688     , 17.192    , 18.509   , 20.569   , 22.465  , 24.797 , 27.836 , 30.178, 32.282, 34.336, 36.475, 38.859, 41.778, 46.059, 49.802, 53.203, 57.342, 60.275, 66.619, 69.198,
   14.401      , 15.324     , 17.887    , 19.233   , 21.336   , 23.269  , 25.643 , 28.735 , 31.115, 33.252, 35.336, 37.505, 39.922, 42.879, 47.212, 50.998, 54.437, 58.619, 61.581, 67.985, 70.588,   
   15.020      , 15.965     , 18.586    , 19.960   , 22.106   , 24.075  , 26.492 , 29.635 , 32.053, 34.222, 36.336, 38.535, 40.984, 43.978, 48.363, 52.192, 55.668, 59.892, 62.883, 69.346, 71.972,  
   15.644      , 16.611     , 19.289    , 20.691   , 22.878   , 24.884  , 27.343 , 30.537 , 32.992, 35.192, 37.335, 39.564, 42.045, 45.076, 49.513, 53.384, 56.895, 61.162, 64.181, 70.703, 73.351, 
   16.273      , 17.261     , 19.996    , 21.426   , 23.654   , 25.695  , 28.196 , 31.441 , 33.932, 36.163, 38.335, 40.593, 43.105, 46.173, 50.660, 54.572, 58.120, 62.428, 65.476, 72.055, 74.725,
   
   16.906      , 17.916     , 20.707    , 22.164   , 24.433   , 26.509  , 29.051 , 32.345 , 34.872, 37.134, 39.335, 41.622, 44.165, 47.269, 51.805, 55.758, 59.342, 63.691, 66.766, 73.402, 76.095,
   17.544      , 18.575     , 21.421    , 22.906   , 25.215   , 27.326  , 29.907 , 33.251 , 35.813, 38.105, 40.335, 42.651, 45.224, 48.363, 52.949, 56.942, 60.561, 64.950, 68.053, 74.745, 77.459,
   18.184      , 19.238     , 22.138    , 23.650   , 25.999   , 28.144  , 30.765 , 34.157 , 36.755, 39.077, 41.335, 43.679, 46.282, 49.456, 54.090, 58.124, 61.777, 66.206, 69.336, 76.084, 78.820, 
   18.832      , 19.905     , 22.859    , 24.398   , 26.785   , 28.965  , 31.625 , 35.065 , 37.698, 40.050, 42.335, 44.706, 47.339, 50.548, 55.230, 59.304, 62.990, 67.459, 70.616, 77.418, 80.176,
   19.482      , 20.576     , 23.584    , 25.148   , 27.575   , 29.787  , 32.487 , 35.974 , 38.641, 41.022, 43.335, 45.734, 48.396, 51.639, 56.369, 60.481, 64.201, 68.709, 71.893, 78.749, 81.528,
   
   20.136      , 21.251     , 24.311    , 25.901   ,
   20.794      , 21.929     , 25.041    , 
   21.456      , 22.610     ,
   22.121      , 23.295     ,
   22.789      , 23.983     ,
   
   23.461      , 24.674     ,
}

-- table size
function chi2.table.size()
   return table.getn(chi2.table2.val)
end

-- print("chi2.table.size()="..chi2.table.size())
