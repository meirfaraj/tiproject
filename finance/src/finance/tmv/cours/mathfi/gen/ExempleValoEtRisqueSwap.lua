--------------------------------------------------------------------------
-- cours exported from ExempleValoEtRisqueSwap.txt
--------------------------------------------------------------------------


ExempleValoEtRisqueSwap = Tmv(EXEMPLE_VALO_ET_RISQUE_SWAP_TITLE_ID,EXEMPLE_VALO_ET_RISQUE_SWAP_TITLE_HEADER_ID)

function ExempleValoEtRisqueSwap:performCalc()
  self:appendToResult("")
  self:appendTitleToResult("Exemple: valorisation et risque swap vanille")
  self:appendToResult("\n")
  self:appendToResult("swap preteur(tx fixe receveur)  de 4 ans de durée le 01/10/n-1, N=100M,")
  self:appendToResult("jambe variable E6R(coupon semestriel 01-04 et 01-10) et jambe fixe coupon annuel k=5% versé le 01/10/n,n+1,n+2,n+3")
  self:appendToResult("dates reset et les gammes de tx plates de la ")
  self:appendBoldToResult("Jv")
  self:appendToResult(" ainsi que Nj(t-1,t):\n")
  self:appendToResult("01/10/n-1 tx plat: 5,5%, 01/4/n: 5%(182), 01/10/n=5.5%(183), 01/04/n+1: 5.5%(182), 01/10/n+1: 5%(183) \n")
  self:appendToResult("\n")
  self:appendToResult("1)01/10/n+1 (après versement de coupon): gamme des taux plate 5% (taux fixe BTAN 4 ans et tx fixe swap 4 ans)\n")
  self:appendToResult("valeur marché du swap V=0 car composantes fixes et variables au pair\n")
  self:appendToResult("\n")
  self:appendToResult("2)31/3/n:gamme plate et tous les tx égaux à 6%, donc juste avant versement de coupon V(S(k-r):\n")
  self:appendToResult("le coupon variable du 01/04/n = ")
  self:appendMathToResult(" Cn=100000*5.5%*182/360=2780.5K ")
  self:appendToResult(" donc V(Ar) = 100000+Cn=102780.5K \n")
  self:appendToResult("")
  self:appendMathToResult(" V(Ak)=100000 * (1.06)^1/2 * ( "..sum_sym.."((0.05/1.06^t)+100*1/1.06^4) = 99388.8 K ,t,1,4)")
  self:appendToResult(" \n")
  self:appendToResult("Donc ")
  self:appendMathToResult("V(S(k-r))=-3391.7K")
  self:appendToResult(" \n ")
  self:appendToResult("\n")
  self:appendToResult("3) 01/10/n : (après coupons) tous les ts sont 5.5% calcul de la valeur des swaps par 2 méthodes: \n")
  self:appendToResult("Méthode démantèlement: V(Ar)=100000K\n")
  self:appendToResult("")
  self:appendMathToResult(" V(Ak)=100000 * ( "..sum_sym.."((0.05/1.055^t)+100*1/1.055^3) = 98651.033 K ,t,1,3)")
  self:appendToResult(" \n ")
  self:appendToResult("Donc V(S(k-r))=-1348.966K \n ")
  self:appendToResult("Méthode équivalence: ")
  self:appendMathToResult(" V(S(k-r))=100000 (5%-5.5%) * ( "..sum_sym.."((1/1.055^t)) = -1348.966K ,t,1,3)")
  self:appendToResult(" \n ")
  self:appendToResult("\n")
  self:appendToResult("4) le 30/12/n-1, E(3mois)=5% aainsi que tous les autres tx. Calculons incidence d'une hausse des tx de 0.2% le 30/12/n-1 \n")
  self:appendToResult("On la formule ")
  self:appendMathToResult("dV(S(k-r))/dr=dV(A(k))/dr - dV(A(r))/dr ")
  self:appendToResult(" et ")
  self:appendMathToResult("A(r)=F * D/(1+rD)^2")
  self:appendToResult(" donc ")
  self:appendMathToResult("dV(A(r))/dr= -FD/(1+rD)^2")
  self:appendToResult(" \n")
  self:appendToResult("Le 30/12/n-1, les tx sont tous égaux à 5%, dès lors une variation DELTA(r)=0.2% implique au premier ordre :\n")
  self:appendToResult("")
  self:appendMathToResult(" DELTA(V(Ar))=-DELTA(r) * F * D/(1+rD)^2 = -0.002 * 102780.5 * 0.25 / (1+0.25*0.05)^2 = -50.129K ")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendMathToResult(" V(Ak)="..sum_sym.."((Fi/(1+r)^t-0.25) ,t,1,4)")
  self:appendToResult(" donc ")
  self:appendMathToResult("dV(A(k))/dr= - "..sum_sym.."(((t-0.25)Fi/(1+r)^t+0.75) ,t,1,4)")
  self:appendToResult(" au premier ordre :\n")
  self:appendToResult("")
  self:appendMathToResult(" DELTA(V(Ak))= DELTA(r) * dV(A(k))/dr = -0.002 * 334845.004 = -669.69K ")
  self:appendToResult(" \n")
  self:appendToResult("Donc DELTA(r) = 0.2% implique DELTA(V(S))=-669.69+50.129=-619.56K ")
  self:appendToResult("\n\n")

end

