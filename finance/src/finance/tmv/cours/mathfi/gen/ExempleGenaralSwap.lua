--------------------------------------------------------------------------
-- cours exported from ExempleGenaralSwap.txt
--------------------------------------------------------------------------


ExempleGenaralSwap = Tmv(EXEMPLE_GENARAL_SWAP_TITLE_ID,EXEMPLE_GENARAL_SWAP_TITLE_HEADER_ID)

function ExempleGenaralSwap:performCalc()
  self:appendToResult("")
  self:appendTitleToResult("Exemple: valorisation de swap")
  self:appendToResult("Le 1/1/n date(0), courbe des swap plate à 4%(quelque soit la matu, k=4%) \n")
  self:appendToResult("swap preteur X de 100M, 4 années à courir, taux fixe receveur/L-3mois révisable donneur, contracté \n")
  self:appendToResult("à une date antérieure au taux fixe 5%, coupons révisable payés trimestriellement(31/3,30/6,30/9,31/12) \n")
  self:appendToResult("et le coupon fixe le 31/12. L3-mois(30/9/n-1)=4%(dernère date de reset) \n")
  self:appendToResult("\n")
  self:appendToResult("On calcule valeur du swap le 1/1/n selon 2 méthodes, puis sa valeur le 30/12/n-1:")
  self:appendToResult("\n")
  self:appendToResult("a)1/1/n(0+, juste après le règlement)")
  self:appendToResult("\n")
  self:appendToResult("Méthode démantèlement:V0(S(k-r))=V0+(A(k)) - V0+(A(r))")
  self:appendToResult("A(r) étant au pair V0+(A(r))=100\n")
  self:appendToResult("Courbe des taux plate donc taux ZC utilisés pour actualisé A(k) sont égaux aux taux fixe swap(courbe plate)\n")
  self:appendToResult("")
  self:appendMathToResult("V0+(A(k))=5*"..sum_sym.."((1/1.04^t)+100*1/1.04^4=103.63,t,1,4)")
  self:appendToResult("\n")
  self:appendToResult("donc ")
  self:appendMathToResult("V0(S(k-r))=3.63M")
  self:appendToResult(" Euro\n")
  self:appendToResult("\n")
  self:appendToResult("Méthode équivalence:")
  self:appendMathToResult("V0+(S(k-r))=(5-4)"..sum_sym.."((1/1.04^t)=3.63,t,1,4)")
  self:appendToResult("M Euro")
  self:appendToResult("\n")
  self:appendToResult("b) valeur le 30/12/n-1 en 0-, juste avant règlement:")
  self:appendToResult("\n")
  self:appendToResult("rajouter pour chaque composante le coupon(annuel pour le fixe et semestriel pour le variable(")
  self:appendMathToResult("D = Nj/Na = 0.25")
  self:appendToResult(") \n")
  self:appendToResult("")
  self:appendMathToResult("V0-(A(k))=103.63+5=108.63")
  self:appendToResult(", ")
  self:appendMathToResult("V0-(A(r))=100 + 4 * 0.25=101")
  self:appendToResult(" donc ")
  self:appendMathToResult("V0-(S(k-r))=7.63")
  self:appendToResult("M Euro \n")
  self:appendToResult("\n")
  self:appendToResult("")
  self:appendBoldToResult("B.")
  self:appendToResult(" Un an plus tard 1/1/n+1(donc le Swap lui reste 3 ans), la gamme des taux fixe swap(k(theta)) évolue\n")
  self:appendToResult("1an: 6%, 2ans: 6.5%, 3ans=7%, 4ans: 7.2%\n")
  self:appendToResult("\n")
  self:appendToResult("commencer calcul gamme ZC 1,2 et 3 ans implicite puis on calcule la valeur du swap(L-3mois contre 5%)")
  self:appendToResult("\n")
  self:appendToResult("a)calcul des prix b(theta) et des ZC à partier de k(theta)")
  self:appendToResult("\n")
  self:appendToResult("")
  self:appendMathToResult("r1=k1=6%")
  self:appendToResult("donc ")
  self:appendMathToResult("b1=1/1.06=0.9434")
  self:appendToResult("; En écrivant q'un titre à 2 ans de coupon k2 est au pair, il vient: \n")
  self:appendToResult("")
  self:appendMathToResult("1=k2b1+(1+k2)b2=0.065*0.9434+1.065b2")
  self:appendToResult(", soit ")
  self:appendMathToResult("b2=0.8814")
  self:appendToResult(" donc ")
  self:appendMathToResult("r2=6.516%")
  self:appendToResult(" (")
  self:appendMathToResult("b2 = 1/(1+r2)^2")
  self:appendToResult(") \n")
  self:appendToResult("de même pour 3 ans k3:1=k(3)b(1)+k(3)b(2)+(1+k(3))b(3) donc b(3)=0.8152 et r3=7.048% \n\n")
  self:appendToResult("b)valeur du swap le 1/1:n+1: par démantèlement=")
  self:appendMathToResult("V0+(A(r))=100M")
  self:appendToResult(",")
  self:appendMathToResult("V0+(A(k))=5*(b(1)+b(2))+105*b(3)=94.72")
  self:appendToResult("M \n")
  self:appendToResult("")
  self:appendMathToResult("V0+(S(k-r))=-5.28M")
  self:appendToResult("; Par équivalence: ")
  self:appendMathToResult("V0+(S(k-r))=(5-7)*(b1+b2+b3)=-5.28")
  self:appendMathToResult("M")
  self:appendToResult("\n")

end

