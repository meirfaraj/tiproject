--------------------------------------------------------------------------
-- cours exported from marchéObligataire.txt
--------------------------------------------------------------------------


MarcheObligataire = Tmv(MARCHE_OBLIGATAIRE_TITLE_ID,MARCHE_OBLIGATAIRE_TITLE_HEADER_ID)

function MarcheObligataire:performCalc()
  self:appendToResult("")
  self:appendTitleToResult("march"..e_acute.." obligataire")
  self:appendToResult("")
  self:appendTitleToResult("valeur "..a_grave.." t quelconque")
  self:appendToResult("")
  self:appendMathToResult("V(r(t))= ((1+r(t))^t) * (F1/(1+r)+F2/(1+r)^2+...+FT/(1+r)^T)")
  self:appendToResult(" avec ")
  self:appendMathToResult("t=Nj/Na")
  self:appendToResult(" temps "..e_acute.."coul"..e_acute.." depuis ")
  self:appendMathToResult("t=0")
  self:appendToResult("Ivi on a fait une capitalisationde la valeur de l'obligation "..a_grave.." l'instant t")
  self:appendToResult("")
  self:appendTitleToResult("cotation des obligations")
  self:appendToResult("")
  self:appendMathToResult("Cc=100kT")
  self:appendToResult(" avec ")
  self:appendMathToResult("T=Nj/Na")
  self:appendToResult("Le cours plein coupon C'(t) "..a_grave.." ")
  self:appendMathToResult("t=Nj/Na")
  self:appendToResult(" ")
  self:appendMathToResult("V(t)=C'(t)*V(n)/100")
  self:appendToResult("\n")
  self:appendToResult("")
  self:appendMathToResult("C'(t) = 100 * ((1+r(t))^t) * (k/(1+r)+k/(1+r)^2+...+(1+k)/(1+r)^T)")
  self:appendToResult("\n")
  self:appendToResult("Le cours pied coupon : ")
  self:appendMathToResult("C(t) = C'(t) - 100 * k * t")
  self:appendToResult(" avec ")
  self:appendMathToResult("t = Nj/Na")
  self:appendToResult("\n")
  self:appendToResult("")
  self:appendTitleToResult("Variation, sensibilit"..e_acute.." et Duration d'un titre "..a_grave.." revenus fixes")
  self:appendToResult("")
  self:appendBoldToResult("Sensibilit"..e_acute.." : ")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendMathToResult("S=-dV/Vdr = (1/(1+r)) * (1/V * Somme(t*F(t)/(1+r)^t))")
  self:appendToResult("")
  self:appendMathToResult("=D/(1+r)")
  self:appendToResult(" donc c'est la duration diviser par 1+r \n")
  self:appendToResult("")
  self:appendMathToResult("DELTA V/V = -S DELTA r")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendMathToResult("D=S*(1+r)")
  self:appendToResult(" \n")
  self:appendToResult("Pour un ")
  self:appendBoldToResult(" z"..e_acute.."ro coupon ")
  self:appendToResult(" ")
  self:appendMathToResult("D=T*F(T)/V*(1+r)^T")
  self:appendToResult(" or ")
  self:appendMathToResult("V=F(T)/(1+r)^T")
  self:appendToResult(" donc ")
  self:appendMathToResult("D=T")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendTitleToResult("Exemple: valorisation et risue rente perp"..e_acute.."tuelle ")
  self:appendToResult("\n")
  self:appendToResult("1) Pour une ")
  self:appendBoldToResult(" rente perp"..e_acute.."tuelle ")
  self:appendToResult(" qui verse x ")
  self:appendMathToResult("V= Somme (x/(1+r)^t)")
  self:appendToResult(" de ")
  self:appendMathToResult("t=1")
  self:appendToResult(" jusqu'"..a_grave.." l'infini donc ")
  self:appendMathToResult("V=x/r")
  self:appendToResult("\n")
  self:appendToResult("")
  self:appendMathToResult("S=-dLnV/dr=1/r")
  self:appendToResult(" et ")
  self:appendMathToResult("D = S * (1+r)=(1+r)/r")
  self:appendToResult(" \n")
  self:appendToResult("2)Consid"..e_acute.."rons une rente perp"..e_acute.."tuelle de valeur nominale "..e_acute.."gale "..a_grave.." 1, dont le taux de rentabilit"..e_acute.." (taux")
  self:appendToResult("actuariel continu) est r et de le taux de coupon est k (elle distribue un coupon annuel k "..a_grave.." l?infini) \n")
  self:appendToResult("On se situe "..a_grave.." une date quelconque entre deux coupons, t ann"..e_acute.."es apr"..e_grave.."s le pr"..e_acute.."c"..e_acute.."dent d"..e_acute.."tachement et (o"..u_grave.." t est compris entre 0 et 1) \n")
  self:appendToResult("Le taux discret est ")
  self:appendMathToResult("r = exp(rc) - 1")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendMathToResult("V = (1+r)^t * ( "..sum_sym.."((k/(1+r)^t))= (k/r) * (1+r)^t,t,1,infini)")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendTitleToResult("Exemple: taux continus montrer que S=D ")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendMathToResult("V = Somme{t=t1 -> tN}(Ft * exp(-rt))")
  self:appendToResult("")
  self:appendMathToResult("S=-dV/Vdr = Somme{t=t1 -> tN}(Ft/V * exp(-rt) * t) = D")
  self:appendToResult(" \n")
  self:appendToResult("")
  self:appendMathToResult("V = integrale{t=0 -> T}(f(t) * exp(-rt) * dt)")
  self:appendToResult(" et donc ")
  self:appendMathToResult("S=-dV/Vdr = (1/V) * integrale{t=0 -> T}(t * f(t) * exp(-rt) * dt) = D")
  self:appendToResult("\n")
  self:appendToResult("La ")
  self:appendBoldToResult("convexit"..e_acute.."")
  self:appendToResult(" pour une appr"..e_acute.."ciation plus fine")
  self:appendToResult("")
  self:appendMathToResult("DELTA V/V=-S DELTA r = 1/V * dV/dr * DELTA r")
  self:appendToResult(" \n")
  self:appendToResult("d"..e_acute.."veloppement "..a_grave.." l'ordre 2 donne \n")
  self:appendToResult("")
  self:appendMathToResult("DELTA V/V=-S DELTA r + 1/2 * C (DELTA r)^2")
  self:appendToResult("avec ")
  self:appendMathToResult("C = 1/V d^2V/dr^2 = 1/V * 1/(1+r)^2")
  self:appendToResult(" Somme ")
  self:appendMathToResult("(t*(t+1)*F(t)/(1+r)^t)")
  self:appendToResult("\n\n")
  self:appendToResult("Exemple : ")
  self:appendToResult("obligation 10 ans "..a_grave.." courir, de 100?, k=6%,r=5% \n")
  self:appendToResult("")
  self:appendMathToResult("V="..sum_sym.."((6/1.05^t)+106/(1.05)^10=107.72,t,1,9)")
  self:appendToResult("? \n")
  self:appendToResult("Sa sensibilit"..e_acute.." ")
  self:appendMathToResult("S=-dV/Vdr=1/(1.05*107.72) * [1 * 6/1.05 + 2 * 6/1.05^2 +...+ 10 * 106/1.05^10]=7.52")
  self:appendToResult(" \n")
  self:appendToResult("Duration ")
  self:appendMathToResult("D=1.05*S = 7.89")
  self:appendToResult(" ans \n")
  self:appendToResult("hausse de taux de 1% traduit approximativement, par une baisse de valeur de titre de 7.52% \n")
  self:appendToResult("")
  self:appendTitleToResult("Exemple ")
  self:appendToResult(": \n")
  self:appendToResult("obligation 10 ans, venant de d"..e_acute.."tacher un coupon 5%,")
  self:appendToResult("")
  self:appendMathToResult("r=5% ")
  self:appendToResult("donc obligation actuellement au pair \n")
  self:appendToResult("")
  self:appendMathToResult("V(5%)="..sum_sym.."((5/1.05^t)+100/(1.05)^10=100,t,1,10)")
  self:appendToResult("? \n")
  self:appendToResult("pour ")
  self:appendMathToResult("r=5.1% V(5,1%)="..sum_sym.."((5/1.051^t)+100/(1.051)^10=99.23,t,1,10)")
  self:appendToResult("? \n")
  self:appendToResult("Sa sensibilit"..e_acute.." ")
  self:appendMathToResult("S=-DeltaV/VDr=0.77/100*0.001=7.7")
  self:appendToResult(" \n")
  self:appendToResult("d'o"..u_grave.." ")
  self:appendMathToResult("Duration D=1.05*7.7 = 8.09")
  self:appendToResult(" ans")
  self:appendToResult("\n")
  self:appendToResult("")
  self:appendTitleToResult("Exemple")
  self:appendTitleToResult(": rente perp"..e_acute.."tuelle avec r et k")
  self:appendToResult("")
  self:appendMathToResult("V=k/r")
  self:appendToResult(", ")
  self:appendMathToResult("S=-dV/Vdr=1/r")
  self:appendToResult(", ")
  self:appendMathToResult("C=1/V * d^2V/dr^2=2k/Vr^3=2/r^2")
  self:appendToResult("")
  self:appendMathToResult("r=10%")
  self:appendToResult(" donc ")
  self:appendMathToResult("S=10")
  self:appendToResult(" et ")
  self:appendMathToResult("C=200")
  self:appendToResult("Lors de la hausse de taux de 2% implique une baisse de la valeur calculable")
  self:appendToResult("")
  self:appendMathToResult("-Delta(V)/V=SDelta(r)-1/2*C*Delta(r)^2=10*0.02-100*(0.02)^2=16%")
  self:appendToResult("\n")

end

